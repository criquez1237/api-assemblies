meta {
  name: Create Product - Duplicate Name Error
  type: http
  seq: 10
}

post {
  url: {{baseUrl}}/v1/products/upsert
  body: json
  auth: bearer
}

auth:bearer {
  token: {{adminToken}}
}

body:json {
  {
    "name": "iPhone 15 Pro Max",
    "description": "Intento de crear producto con nombre duplicado",
    "specifications": [],
    "brandName": "Apple",
    "price": 999.99,
    "gallery": [],
    "subCategoryId": "subcat123",
    "stockQuantity": 10,
    "actived": true,
    "visible": true
  }
}

tests {
  test("Response status is 400 for duplicate name", function() {
    expect(res.getStatus()).to.equal(400);
  });
  
  test("Error message indicates duplicate name", function() {
    expect(res.getBody()).to.have.property('success');
    expect(res.getBody().success).to.equal('true');
    expect(res.getBody().message).to.contain('Error');
    expect(res.getBody().message).to.contain('Ya existe un producto con el nombre');
  });
}
